* Author Guidelines

* Under the Hood

#+BEGIN_SRC makefile :tangle coq.mk
COQ_POSTS := $(shell find site/ -name "*.v")
COQ_HTML := $(COQ_POSTS:.v=.html)

coq-build : ${COQ_HTML}

theme-build : site/style/coq.sass
soupault-build : coq-build

ARTIFACTS += *.vo *.vok *.vos .*.aux *.glob .lia.cache
ARTIFACTS += ${COQ_HTML}

COQLIB := "https://coq.inria.fr/distrib/current/stdlib/"
COQCARG := -async-proofs-cache force \
           -w -custom-entry-overriden
COQDOCARG := --no-index --charset utf8 --short \
             --body-only --coqlib "${COQLIB}"

%.html : %.v coq.mk
	@cleopatra echo Exporting "$*.v"
	@coqc ${COQCARG} $<
	@coqdoc ${COQDOCARG} -d $(shell dirname $<) $<
	@rm -f $(shell dirname $<)/coqdoc.css
#+END_SRC

#+BEGIN_SRC sass :tangle site/style/coq.sass
@mixin patchy-centered($inc: 0rem)
    width : 100vw
    position: relative
    @media screen and (min-width : $document-width)
        padding-left : calc(50vw - #{$document-width} / 2)
        right : calc(50vw - #{$document-width} / 2)
    @media screen and (max-width : $document-width)
        padding-left : 1rem
        right : 1rem

div.code
    white-space: nowrap

.doc
    @include padding-centered
    margin-top : 1em
    margin-bottom : 1em

    pre
        @include patchy-centered
        padding-top : 1rem
        padding-bottom : 1rem
        background : $bg-verbatim
        overflow-x : auto

.code
    @include padding-centered
    @include code-block

.inlinecode
    @include code-font

h1, h2, h3, h4, h5, h6
    .inlinecode
        font-size: 100%

.code
    .id[title="keyword"]
        color : #ff6188

    .id[title="definition"],
    .id[title="projection"],
    .id[title="theorem"],
    .id[title="lemma"]
        color : #a9dc76

    .id[title="inductive"],
    .id[title="record"],
    .id[title="axiom"],
    .id[title="class"]
        color : #78dce8

    .id[title="constructor"]
        color : #ab9df2

    a[href]
        color : inherit
        text-decoration : none
        background : #403e41
        padding : .05rem .15rem .05rem .15rem
        border-radius : 15%

        .url-mark
            display: none

.paragraph
    margin-top: 1em
    margin-bottom: 1em

#+END_SRC

# Local Variables:
# org-src-preserve-indentation: t
# End:
